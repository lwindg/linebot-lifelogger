<!--
Sync Impact Report:
Version: 2.0.0 (English to Traditional Chinese translation)
Modified Principles: N/A (translation only, principles remain the same)
Added Sections: N/A
Removed Sections: N/A
Changes from 1.1.0:
  - Translated entire constitution from English to Traditional Chinese (正體中文)
  - Maintained all core principles and structure
  - Aligned with language requirement: Traditional Chinese for internal planning documents
Templates Status:
  ✅ plan-template.md - no changes required (language-agnostic structure)
  ✅ spec-template.md - no changes required (language-agnostic structure)
  ✅ tasks-template.md - no changes required (language-agnostic structure)
Follow-up TODOs: None
-->

# LINE Bot LifeLogger 專案憲章

## 核心原則

### I. MVP 優先開發

每個功能**必須**以最小可行產品（MVP）開始，提供即時使用者價值。

**規則**：
- 實作解決核心使用者問題的最簡單方案
- 每個使用者故事必須可獨立測試和交付
- 優先處理 P1 功能；延後 P2/P3 直到 MVP 驗證方法
- 不做推測性功能——只構建使用者明確需要的功能

**理念**：快速驗證和迭代勝過全面規劃。MVP 優先確保我們快速學習、快速失敗，並持續交付價值，不浪費精力在未使用的功能上。

### II. 透過測試確保品質

程式碼品質不容妥協，但測試必須務實且專注於使用者場景。

**規則**：
- 為所有使用者導向功能和關鍵路徑編寫測試
- 專注於驗證端到端使用者旅程的整合測試
- 單元測試為選用——僅在複雜度需要隔離時使用
- 所有測試必須在部署前通過
- 測試覆蓋率針對行為，而非任意百分比目標

**理念**：測試確保可靠性並支援自信的重構。使用者旅程測試相較於詳盡的單元測試，以最小開銷提供最大價值。

### III. 簡單勝過完美

避免過度工程。選擇最簡單可行的方案。

**規則**：
- 偏好直接實作而非抽象層（例如：除非被證明必要，否則不使用 Repository 模式）
- 不過早優化——僅在效能問題被測量時才優化
- 避免為「未來彈性」添加框架、函式庫或模式
- 每個複雜度決策**必須**有具體當前需求的理由
- 預設使用更少檔案、更少層級、更少依賴

**理念**：複雜度是債務。簡單的程式碼更容易理解、測試和修改。YAGNI（你不會需要它）原則保持開發快速和維護成本低。

### IV. 便利性和開發者體驗

開發者效率直接影響交付速度。減少各處摩擦。

**規則**：
- 自動化重複性任務（linting、格式化、測試、部署）
- 清晰的錯誤訊息和日誌以便快速除錯
- 本地開發必須以最少設定即可運作
- 文件即程式碼註解 + 可執行快速入門——除非必要否則不另寫手冊
- 在可能的情況下使用慣例優於配置

**理念**：花在工具設定、除錯神秘錯誤或搜尋文件的時間，就是沒有花在交付功能的時間。良好的開發者體驗帶來複利式的生產力提升。

### V. 可用性和使用者價值

每個決策必須優化終端使用者價值和可用性。

**規則**：
- 使用者體驗優先於技術優雅
- 功能必須解決真實的使用者痛點，而非理論問題
- 及早收集使用者回饋並根據實際使用情況迭代
- 效能目標必須以使用者為中心（回應時間、可靠性）
- 錯誤處理必須對使用者友善，而非對開發者友善

**理念**：機器人的存在是為了服務使用者。不改善使用者結果的技術決策都是分心。

## 開發工作流程

### 溝通與文件語言

規格與內部設計文件**必須**使用正體中文。所有程式碼相關產物**必須**使用英文。

**正體中文 - 用於內部規劃**：
- 規格文件（spec.md）
- 規劃文件（plan.md、research.md、data-model.md）
- 任務描述（tasks.md）
- 團隊內部討論和釐清
- 使用者故事和驗收標準

**英文 - 用於程式碼和外部產物**：
- 所有原始碼（變數名稱、函式名稱、類別名稱）
- 程式碼註解和文件字串
- 提交訊息
- Pull request 標題和描述
- 圖表和流程圖（使用英文標籤）
- 技術術語和 API 參考
- 錯誤訊息和日誌輸出
- README 和對外文件

**理念**：正體中文用於內部規劃確保精確的需求捕捉和快速的團隊理解。英文用於所有程式碼產物確保國際協作就緒性、工具相容性，以及與全球開發標準一致。

### 功能開發流程

1. **制定規格**：定義使用者場景和驗收標準（spec.md）
2. **規劃**：研究並設計技術方法（plan.md + 研究產物）
3. **釐清**：在實作前解決規格不足之處
4. **任務化**：拆解為依賴排序、可獨立測試的任務（tasks.md）
5. **實作**：依優先順序執行任務（P1 → P2 → P3）
6. **驗證**：針對原始驗收標準測試

**檢查點**：
- 沒有定義使用者場景就不實作
- 沒有技術計畫就不產生任務
- 沒有通過測試就不部署

### 測試策略

- **整合測試**：所有使用者旅程必須（LINE 訊息流程 → GPT → 回應）
- **契約測試**：外部 API 整合必須（LINE API、OpenAI API）
- **單元測試**：選用——僅用於需要隔離的複雜業務邏輯
- **手動測試**：首次發布前的 MVP 驗證必須

### 漸進式交付

- 每個使用者故事必須可獨立部署
- P1 故事構成 MVP——在 P2/P3 之前部署並驗證
- 使用功能旗標或分支隔離未完成工作
- 每次部署必須是可發布的增量

### Git 工作流程

**分支命名格式**：`$action/$description`
- 範例：
  - `feat/integrate-line`
  - `fix/response-token-too-short`
  - `refactor/simplify-gpt-prompt`
  - `docs/update-readme`

**提交訊息格式**：`$action(service/module/component): $message`
- 範例：
  - `fix(linebot): error message`
  - `feat(webhook): add retry logic`
  - `refactor(gpt): simplify prompt structure`
  - `docs(readme): add deployment guide`

**允許的動作**：
- `release` — 發布新版本
- `feat` — 新功能
- `fix` — 錯誤修復
- `refactor` — 程式碼重構（無功能變更）
- `docs` — 文件更新
- `test` — 測試更新或新增
- `style` — 程式碼風格變更（格式化、空白）
- `chore` — 其他雜項變更（建置、工具）

**提交指南**：
- 保持提交訊息簡潔且描述性
- 使用祈使語氣（例如：「add」而非「added」或「adds」）
- 適當時參考議題編號（例如：`fix(linebot): handle empty messages (#42)`）
- 每次提交一個邏輯變更

**分支策略**：
- `main` — 可用於生產環境的程式碼
- `feat/*` — 功能開發分支
- `fix/*` — 錯誤修復分支
- 所有變更建立 pull request
- 合併後刪除分支

## 技術約束

### 強制性品質標準

- **安全性**：程式碼中不得有硬編碼的秘密（使用環境變數）
- **錯誤處理**：所有外部 API 呼叫必須妥善處理失敗
- **日誌**：記錄所有使用者互動和錯誤以便除錯
- **效能**：LINE webhook 回應必須在 3 秒內完成（平台限制）

### 技術堆疊

- **語言**：Python 3.11+
- **框架**：Flask（最小化網頁框架）
- **API**：LINE Messaging API、OpenAI API
- **測試**：pytest 用於整合／單元測試
- **部署**：透過環境變數進行環境特定（dev/prod）配置

### 除非有理由否則避免

- ORM 框架（如需資料庫則使用直接資料庫查詢）
- 複雜的狀態管理（保持機器人無狀態或使用簡單的 session 儲存）
- 微服務架構（在被證明為瓶頸前使用單體）
- 前端框架（機器人介面是 LINE 應用程式）

## 治理

### 憲章權威

本憲章優先於所有其他開發實踐和偏好。當有疑問時，回顧五個核心原則：MVP 優先、透過測試確保品質、簡單勝過完美、便利性和開發者體驗，以及可用性和使用者價值。

### 合規要求

- 所有 PR 必須包含引入任何複雜度的理由
- 程式碼審查必須明確驗證：這是否符合憲章原則？
- 任何偏離原則的情況都需要在 PR 描述中記錄理由
- 違反憲章的情況會阻止合併，除非明確核准為例外

### 修訂流程

1. 提出修訂案並附上理由和影響分析
2. 記錄修訂案解決的問題
3. 遵循語義化版本更新版本：
   - **MAJOR**：移除或重新定義核心原則（不向後相容）
   - **MINOR**：新增原則或擴充現有指導
   - **PATCH**：釐清、措辭改進、錯字修正
4. 將變更傳播到所有相依模板（plan、spec、tasks）
5. 在同步影響報告中附上變更日誌提交

### 複雜度理由模板

當違反簡單性原則時，在 plan.md 中記錄：

| 違反項目 | 為何需要 | 拒絕的更簡單替代方案及原因 |
|---------|---------|------------------------|
| [新增的模式/函式庫] | [具體當前問題] | [為何更簡單方案不足] |

**版本**：2.0.0 | **批准日期**：2025-11-11 | **最後修訂**：2025-11-12
